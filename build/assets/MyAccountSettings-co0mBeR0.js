import{g as A}from"./vform.es-B4KpagF-.js";import{A as U,B as D}from"./AlertError-DrRZYr7M.js";import{H as E}from"./HasError-OgLSLYZ-.js";import{_ as I,c as d,o as m,a as o,w as n,d as u,T as b,b as a,e as q,t as p,f as w,r as l,L as y,n as L,F as B,u as M}from"./app-DVvTTSt_.js";import{c as N}from"./vue-tel-input-neGMhw29.js";const z={name:"Index",components:{Button:D,HasError:E,AlertError:U,VueTelInput:N},data(){return{authStore:M(),settingsAnimation:!1,show_password:!1,query:!1,form:new A({user_id:"",name:"",tel:"",password:"",recaptcha_token:""}),telValid:!1,showTelErrorMessage:!1}},methods:{async updateUserData(){if(this.telValid!=!0){this.showTelErrorMessage=!0;return}else this.showTelErrorMessage=!1;this.query=!0,this.form.user_id=this.authStore.user.id,this.$recaptchaLoaded().then(()=>{this.$recaptcha("login").then(r=>{this.form.recaptcha_token=r,this.form.post("/user/updateUserData").then(s=>{this.query=!1,this.authStore.getUser(),Toast.fire({title:this.$t("settingsDataUpdatedSuccessfully")})}).catch(s=>{this.query=!1,Toast.fire({icon:"error",title:this.$t("settingsError")})})})})}},mounted(){this.settingsAnimation=!0,document.querySelector(":root").classList.add("PATCH_modal"),this.form.fill(this.authStore.user)},beforeRouteLeave(r,s,_){this.settingsAnimation=!1,setTimeout(()=>{_()},350)}},H={key:0,class:"settings__wrapper"},O={class:"settings__block"},P={class:"settings__header"},F={class:"mx-2"},R={class:"settings__body"},j={class:"alert mt-4 fw-bold text-center"},G=["onSubmit"],J={class:"mb-4"},K={key:0,class:"text-caption mt-1 text-error"},Q={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};function W(r,s,_,X,e,k){const V=l("v-chip"),T=l("v-spacer"),x=l("v-icon"),h=l("v-btn"),g=l("v-text-field"),v=l("validation-provider"),S=l("vue-tel-input"),C=l("validation-observer");return m(),d(B,null,[o(b,{name:"settings__animation-backdrop"},{default:n(()=>[e.settingsAnimation?(m(),d("div",{key:0,class:"settings__backdrop",onClick:s[0]||(s[0]=f=>r.$router.back())})):u("",!0)]),_:1}),o(b,{name:"settings__animation-wrapper"},{default:n(()=>[e.settingsAnimation?(m(),d("div",H,[a("div",O,[a("div",P,[a("div",null,p(e.authStore.user.name),1),a("div",F,"ID: "+p(e.authStore.user.id),1),e.authStore.user.role=="admin"?(m(),q(V,{key:0,size:"small",class:"bg-red-darken-2"},{default:n(()=>[...s[9]||(s[9]=[w("Админ",-1)])]),_:1})):u("",!0),o(T),o(h,{icon:"",dark:"",variant:"text",onClick:s[1]||(s[1]=f=>r.$router.back()),style:{position:"absolute",top:"0",right:"10px"}},{default:n(()=>[o(x,null,{default:n(()=>[...s[10]||(s[10]=[w("mdi-arrow-right",-1)])]),_:1})]),_:1})]),a("div",R,[a("h3",j,p(r.$t("settingsToChangeTheData")),1),o(C,{as:"div",ref:"form"},{default:n(({handleSubmit:f})=>[a("form",{onSubmit:t=>f(t,k.updateUserData),class:"form"},[o(v,{modelValue:e.form.name,"onUpdate:modelValue":s[3]||(s[3]=t=>e.form.name=t),rules:"required|alpha|max:15",name:"name"},{default:n(({errors:t,field:c})=>[o(g,y({modelValue:e.form.name,"onUpdate:modelValue":s[2]||(s[2]=i=>e.form.name=i)},c,{name:"name",label:r.$t("settingsLableName"),type:"text",maxlength:"15",variant:"outlined",color:"blue-darken-2","error-messages":e.form.errors.has("name")?e.form.errors.get("name"):t[0],onInput:i=>e.form.errors.clear("name")}),null,16,["modelValue","label","error-messages","onInput"])]),_:1},8,["modelValue"]),a("div",J,[o(S,{modelValue:e.form.tel,"onUpdate:modelValue":s[4]||(s[4]=t=>e.form.tel=t),onValidate:s[5]||(s[5]=t=>e.telValid=t.valid),style:{height:"56px"},inputOptions:{placeholder:r.$t("settingsLableTel"),showDialCode:!0},class:L({"border border-danger":e.showTelErrorMessage!=""}),validCharactersOnly:!0},null,8,["modelValue","inputOptions","class"]),e.showTelErrorMessage?(m(),d("div",K,p(r.$t("settingsLableTel")),1)):u("",!0)]),o(v,{modelValue:e.form.password,"onUpdate:modelValue":s[8]||(s[8]=t=>e.form.password=t),rules:"min:6|max:30",vid:"пароль",name:"password"},{default:n(({errors:t,field:c})=>[o(g,y({modelValue:e.form.password,"onUpdate:modelValue":s[6]||(s[6]=i=>e.form.password=i)},c,{name:"password",label:r.$t("settingsLablePassword"),type:e.show_password?"text":"password",maxlength:"30",autocomplete:"off",variant:"outlined",color:"blue-darken-2","append-inner-icon":e.show_password?"mdi-eye-outline":"mdi-eye-off-outline","onClick:appendInner":s[7]||(s[7]=i=>e.show_password=!e.show_password),"error-messages":e.form.errors.has("password")?e.form.errors.get("password"):t[0],onInput:i=>e.form.errors.clear("password")}),null,16,["modelValue","label","type","append-inner-icon","error-messages","onInput"])]),_:1},8,["modelValue"]),o(h,{type:"submit",dark:"",block:"",size:"x-large",color:"blue-darken-2 text-body-1",class:"my-2",disabled:e.query},{default:n(()=>[e.query?(m(),d("span",Q)):u("",!0),a("span",null,p(r.$t("settingsToChangeTheData")),1)]),_:1},8,["disabled"])],40,G)]),_:1},512)])])])):u("",!0)]),_:1})],64)}const te=I(z,[["render",W],["__scopeId","data-v-21796fc4"]]);export{te as default};
