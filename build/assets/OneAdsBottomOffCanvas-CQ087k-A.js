import"./vform.es-B4KpagF-.js";import{A as w,B as $}from"./AlertError-DrRZYr7M.js";import{H as S}from"./HasError-OgLSLYZ-.js";import{_ as A,c as s,o as a,v as g,a as u,w as f,d as i,T as y,b as o,t as n,r as b,f as m,F as B,h as O,u as c}from"./app-DVvTTSt_.js";const T={props:{title:String,text:String,url:{type:String,required:!0},onError:Function,onSuccess:Function},methods:{hasSlot(){return!!this.$slots.clickable},share(){const e={title:this.title,text:this.text,url:this.url};navigator.share?navigator.share(e).then(t=>{t&&this.onSuccess(t)}).catch(t=>{onError&&this.onError(t)}):this.onError&&this.onError("method not supported")}}},q={key:1};function I(e,t,p,h,r,l){return a(),s("div",{onClick:t[0]||(t[0]=v=>l.share())},[l.hasSlot()?g(e.$slots,"clickable",{key:0}):(a(),s("p",q,"Share"))])}const D=A(T,[["render",I]]),E={name:"OneAdsBottomOffCanvas",components:{NavigatorShare:D,Button:$,HasError:S,AlertError:w},data(){return{authStore:c(),updateDateLocale:O(),ads:"",oneAdsBottomAnimation:!1,query:!1,SiteDomain}},computed:{tipObekta(){return this.ads.zagolovok!=null?this.ads.zagolovok:this.ads.tip_obekta}},methods:{async addComplain(e){this.query=!0,axios.post("/addComplain",{ads_id:this.ads.id,table_name:this.ads.table_name,user_id:this.authStore.user.id,complain:e}).then(t=>{this.$router.back(),Toast.fire({title:this.$t("oneAdsBottomOffCanvasThanks"),text:this.$t("oneAdsBottomOffCanvasComplainText")}),this.query=!1}).catch(t=>{this.$router.back(),Toast.fire({title:this.$t("oneAdsBottomOffCanvasErrorText"),text:t.response.data.error}),this.query=!1})},async linkShare(e){if(e=="С номером автора"&&navigator.share({url:SiteDomain+"/allAds/"+this.ads.table_name+"/1/allAdsOneAds/"+this.ads.id}),e=="С моим номером"){let t=new URL(window.location).searchParams.has("tel")?new URL(window.location).searchParams.get("tel"):this.authStore.user.tel;navigator.share({url:SiteDomain+"/allAds/"+this.ads.table_name+"/1/allAdsOneAds/"+this.ads.id+"?tel="+t})}},async downloadImage(){this.ads.images.forEach(e=>{let t=document.createElement("a");t.setAttribute("href","/img/adsImg/"+e),t.setAttribute("download",e),t.click()})},async shareImage(){let e=[];for(const t of this.ads.images){const h=await(await fetch("/img/adsImg/"+t)).blob(),r=new File([h],t,{type:h.type});e.push(r)}navigator.canShare({files:e})&&await navigator.share({files:e})}},mounted(){this.oneAdsBottomAnimation=!0,this.ads=JSON.parse(localStorage.getItem("oneAds")),document.querySelector(":root").classList.add("PATCH_modal")},beforeRouteLeave(e,t,p){this.oneAdsBottomAnimation=!1,setTimeout(()=>{p()},350)}},N={key:0,class:"oneAdsBottom__wrapper"},P={class:"oneAdsBottom__block"},F={class:"oneAdsBottom__header"},R={key:0},x={key:1},L={key:2},z={key:3},V={class:"oneAdsBottom__body"},_={key:0,class:"text-center"},H=["href"],U=["href"],W={key:0,class:"mt-2"},G=["href"],J=["href"],M={key:1,role:"button"},j={key:2},K={key:3};function Q(e,t,p,h,r,l){const v=b("v-icon"),k=b("v-btn"),C=b("router-view");return a(),s(B,null,[u(y,{name:"oneAdsBottom__animation-backdrop"},{default:f(()=>[r.oneAdsBottomAnimation?(a(),s("div",{key:0,class:"oneAdsBottom__backdrop",onClick:t[0]||(t[0]=d=>e.$router.back())})):i("",!0)]),_:1}),u(y,{name:"oneAdsBottom__animation-wrapper"},{default:f(()=>[r.oneAdsBottomAnimation?(a(),s("div",N,[o("div",P,[o("div",F,[e.$route.params.type=="Позвонить"?(a(),s("h4",R,[o("span",null,n(r.ads.name),1)])):i("",!0),e.$route.params.type=="Пожаловаться"?(a(),s("h4",x,n(e.$t("oneAdsBottomOffCanvasCallReasonForComplaint")),1)):i("",!0),e.$route.params.type=="Скачать или поделиться фото"?(a(),s("h4",L,n(e.$t("oneAdsBottomOffCanvasDownloadPhotos")),1)):i("",!0),e.$route.params.type=="Поделиться объявлением"?(a(),s("h4",z,n(e.$t("oneAdsBottomOffCanvasShareAnAd")),1)):i("",!0),u(k,{role:"button",icon:"",size:"small",variant:"text",class:"mx-1",style:{position:"absolute",top:"5px",right:"5px"},dark:"",onClick:t[1]||(t[1]=d=>e.$router.back())},{default:f(()=>[u(v,{size:"large"},{default:f(()=>[...t[13]||(t[13]=[m("mdi-close",-1)])]),_:1})]),_:1})]),o("div",V,[e.$route.params.type=="Позвонить"?(a(),s("div",_,[o("div",null,[o("div",null,[e.$route.query.tel==null?(a(),s("a",{key:0,href:"https://api.whatsapp.com/send?phone="+r.ads.tel+"&text="+r.SiteDomain+"/allAds/"+e.$route.params.table_name+"/allAdsOneAds/"+e.$route.params.ads_id,class:"btn text-white text-body-1 mx-1 py-3",style:{width:"100%","max-width":"170px",background:"#10a37f"}},[m(n(e.$t("oneAdsBottomOffCanvasGoToWA"))+" ",1),t[14]||(t[14]=o("i",{class:"bi bi-whatsapp"},null,-1))],8,H)):i("",!0),o("a",{href:"tel: "+String(e.$route.query.tel||r.ads.tel),class:"btn bg-blue text-white text-body-1 mx-1 py-3",style:{width:"100%","max-width":"170px"}},[t[15]||(t[15]=o("i",{class:"bi bi-telephone-fill pr-2"},null,-1)),o("small",null,n(e.$route.query.tel||r.ads.tel),1)],8,U)]),e.$route.query.tel==null?(a(),s("div",W,[r.ads.tel2!=null?(a(),s("a",{key:0,href:"https://api.whatsapp.com/send?phone="+r.ads.tel2+"&text="+r.SiteDomain+"/allAds/"+e.$route.params.table_name+"/allAdsOneAds/"+e.$route.params.ads_id,class:"btn text-white text-body-1 mx-1 py-3",style:{width:"100%","max-width":"170px",background:"#10a37f"}},[m(n(e.$t("oneAdsBottomOffCanvasGoToWA"))+" ",1),t[16]||(t[16]=o("i",{class:"bi bi-whatsapp"},null,-1))],8,G)):i("",!0),r.ads.tel2!=null?(a(),s("a",{key:1,href:"tel:"+r.ads.tel2,class:"btn bg-blue text-white text-body-1 mx-1 py-3",style:{width:"100%","max-width":"170px"}},[t[17]||(t[17]=o("i",{class:"bi bi-telephone-fill pr-2"},null,-1)),o("small",null,n(String(r.ads.tel2)),1)],8,J)):i("",!0)])):i("",!0)])])):i("",!0),e.$route.params.type=="Пожаловаться"?(a(),s("div",M,[o("div",{onClick:t[2]||(t[2]=d=>l.addComplain("Ответил риелтор")),class:"border-bottom p-2 py-3"},n(e.$t("oneAdsBottomOffCanvasTheRealtorReplied")),1),o("div",{onClick:t[3]||(t[3]=d=>l.addComplain("Объявление не актуально")),class:"border-bottom p-2 pb-3"},n(e.$t("oneAdsBottomOffCanvasTheAdIsNotRelevant")),1),o("div",{onClick:t[4]||(t[4]=d=>l.addComplain("Ошибка в цене")),class:"border-bottom p-2 py-3"},n(e.$t("oneAdsBottomOffCanvasPriceError")),1),o("div",{onClick:t[5]||(t[5]=d=>l.addComplain("Некорректные фотографии")),class:"border-bottom p-2 py-3"},n(e.$t("oneAdsBottomOffCanvasIncorrectPhotos")),1),o("div",{onClick:t[6]||(t[6]=d=>l.addComplain("Телефон не отвечает")),class:"border-bottom p-2 py-3"},n(e.$t("oneAdsBottomOffCanvasThePhoneIsNotAnswering")),1),o("div",{onClick:t[7]||(t[7]=d=>l.addComplain("Обман или ложное объявление")),class:"p-2 py-3"},n(e.$t("oneAdsBottomOffCanvasDeceptionOrFalseAnnouncement")),1)])):i("",!0),e.$route.params.type=="Скачать или поделиться фото"?(a(),s("div",j,[o("div",{onClick:t[8]||(t[8]=(...d)=>l.downloadImage&&l.downloadImage(...d)),class:"border-bottom p-2 pb-3",role:"button"},[t[18]||(t[18]=o("i",{class:"bi bi-cloud-arrow-down mx-1"},null,-1)),m(" "+n(e.$t("oneAdsBottomOffCanvasSaveToDevice")),1)]),o("div",{onClick:t[9]||(t[9]=(...d)=>l.shareImage&&l.shareImage(...d)),class:"p-2 py-3",role:"button"},[t[19]||(t[19]=o("i",{class:"bi bi-share mx-1"},null,-1)),m(" "+n(e.$t("oneAdsBottomOffCanvasToShare")),1)])])):i("",!0),e.$route.params.type=="Поделиться объявлением"?(a(),s("div",K,[e.$route.query.tel==null?(a(),s("div",{key:0,onClick:t[10]||(t[10]=d=>l.linkShare("С номером автора")),class:"border-bottom p-2 pb-3",role:"button"},[t[20]||(t[20]=o("i",{class:"bi bi-share mx-1"},null,-1)),m(" "+n(e.$t("oneAdsBottomOffCanvasToShare")),1)])):i("",!0),e.$route.query.tel==null?(a(),s("div",{key:1,onClick:t[11]||(t[11]=d=>r.authStore.check?l.linkShare("С моим номером"):e.$router.push({name:e.$route.name+"Auth"})),class:"p-2 py-3",role:"button"},[t[21]||(t[21]=o("i",{class:"bi bi-share mx-1"},null,-1)),m(" "+n(e.$t("oneAdsBottomOffCanvasShareWithMyPhoneNumber")),1)])):i("",!0),e.$route.query.tel!=null?(a(),s("div",{key:2,onClick:t[12]||(t[12]=d=>l.linkShare("С моим номером")),class:"p-2 py-3",role:"button"},[t[22]||(t[22]=o("i",{class:"bi bi-share mx-1"},null,-1)),m(" "+n(e.$t("oneAdsBottomOffCanvasToShare")),1)])):i("",!0)])):i("",!0)])])])):i("",!0)]),_:1}),u(C)],64)}const et=A(E,[["render",Q],["__scopeId","data-v-a54a127d"]]);export{et as default};
